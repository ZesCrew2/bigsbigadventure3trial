var audioContext=null,scriptNodes={},keepScriptNode=function(){var e=1;return function(t){return t.id=t.id||e++,scriptNodes[t.id]=t,t}}();window.audioContext&&null!=window.audioContext||("undefined"!=typeof AudioContext?audioContext=new AudioContext:"undefined"!=typeof webkitAudioContext&&(audioContext=new webkitAudioContext));var audioContextVolume="undefined"!=typeof audioContext.createGainNode?audioContext.createGainNode():audioContext.createGain();audioContextVolume.connect(audioContext.destination);var toggleMute=function(){audioContextVolume.gain.value=0==audioContextVolume.gain.value?.5:0,document.getElementById("audio").className=0==audioContextVolume.gain.value?"mute":"",setCookie("mute",0==audioContextVolume.gain.value?"mute":"unmute")},HAPIAudio=function(e,t){var o=this;if(e||(e=[]),t||(t=[null]),e.length<1)return!1;if(o.source=[],o.buffer=[],o.context=[],o.volume=[],o.scriptProcessor=[],o.scriptProcessorDisconnect=[],o.panner=[],this.scriptRun=[],o.scriptFunc=[],o.isLoaded=[],o.isPlaying=[],o.startContextTime=[],o.startOffset=[],o.stopContextTimeBegin=[],o.stopContextTimeFinish=[],o.pausedContextTime=[],o.loopStart=[],o.loopEnd=[],o.stopType=[],o.stopInterval=[],o.onEndedFunc=[],o.manualOnEnded=[],Array.isArray(e)&&!Array.isArray(t)){for(var n=[],i=0;i<e.length;i++)n.push(t);t=n}else!Array.isArray(e)&&Array.isArray(t)&&(t=t[0]);if(Array.isArray(e))for(var i=0;i<e.length;i++)o.add(e[i],t[i]);else o.add(e,t)};HAPIAudio.prototype.add=function(e,t){var o=this;o.source.push(e),o.buffer.push(null),o.context.push(null),o.volume.push("undefined"!=typeof audioContext.createGainNode?audioContext.createGainNode():audioContext.createGain()),o.volume[o.volume.length-1].gain.value=1,o.scriptProcessor.push(audioContext.createScriptProcessor(4096,2,2)),o.scriptProcessorDisconnect.push(null),o.panner.push(audioContext.createPanner()),o.panner[o.panner.length-1].panningModel="equalpower",o.panner[o.panner.length-1].distanceModel="linear",o.panner[o.panner.length-1].refDistance=1,o.panner[o.panner.length-1].maxDistance=1e4,o.panner[o.panner.length-1].rolloffFactor=1,o.panner[o.panner.length-1].coneInnerAngle=360,o.panner[o.panner.length-1].coneOuterAngle=0,o.panner[o.panner.length-1].coneOuterGain=0,o.scriptRun.push(!1);o.volume.length-1;o.scriptFunc.push(function(){}),o.scriptProcessor[o.scriptProcessor.length-1].id=o.scriptProcessor.length-1,o.scriptProcessor[o.scriptProcessor.length-1].onaudioprocess=function(e){"function"==typeof o.scriptFunc[this.id]&&1==o.scriptRun[this.id]&&o.scriptFunc[this.id](o,this.id,audioContext.currentTime,e);for(var t=e.inputBuffer,n=e.outputBuffer,i=0;i<n.numberOfChannels;i++)for(var s=t.getChannelData(i),a=n.getChannelData(i),r=0;r<s.length;r++)a[r]=s[r]},o.isLoaded.push(!1),o.isPlaying.push(!1),o.startContextTime.push(!1),o.startOffset.push(!1),o.stopContextTimeBegin.push(!1),o.stopContextTimeFinish.push(!1),o.pausedContextTime.push(!1),o.onEndedFunc.push(!1),o.manualOnEnded.push(!1),o.stopType.push(!1),o.stopInterval.push(!1),"object"==typeof t&&null!=t?(o.loopStart.push(t.loopStart||0==t.loopStart?t.loopStart:0),o.loopEnd.push(t.loopEnd||0==t.loopEnd?t.loopEnd:0)):(o.loopStart.push(0),o.loopEnd.push(0));var n=o.source.length-1;if(-1!=o.source[n].indexOf(";base64,")){var i=o.source[n].split(";base64,");o.source[n]="";for(var s=1;s<i.length;s++)o.source[n]+=""+i[s];var a=Base64Binary.decodeArrayBuffer(o.source[n]);audioContext.decodeAudioData(a,function(e){o.buffer[n]=e,o.isLoaded[n]=!0})}else{var r=new XMLHttpRequest;r.open("GET",o.source[n],!0),r.responseType="arraybuffer",r.onload=function(){audioContext.decodeAudioData(r.response,function(e){o.buffer[n]=e,o.isLoaded[n]=!0})},r.send()}},HAPIAudio.prototype.loop=function(e,t,o,n,i){for(var s=!1,a=0;a<this.isLoaded.length;a++)this.isLoaded[a]!==!0&&(s=!0);if(1==s)return!1;"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=1),"undefined"==typeof o&&(o=1),"undefined"==typeof n&&(n=!1);for(var r=[],a=0;a<this.source.length;a++)r.push(this.slaveLoop(a,e,t,o,n,i));return r},HAPIAudio.prototype.slaveLoop=function(e,t,o,n,i,s,a,r){var u=!0;"undefined"==typeof a&&("undefined"!=typeof this.loopStart[e]?a=this.loopStart[e]:u=!1),"undefined"==typeof r&&("undefined"!=typeof this.loopStart[e]?r=this.loopEnd[e]:u=!1);var d=this.slavePlay(e,t,o,n,i,s);return d===!0&&1==u&&(this.context[e].loopStart=a,this.context[e].loopEnd=r,this.context[e].loop=!0),d},HAPIAudio.prototype.play=function(e,t,o,n,i){for(var s=!1,a=0;a<this.isLoaded.length;a++)this.isLoaded[a]!==!0&&(s=!0);if(1==s)return!1;"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=1),"undefined"==typeof o&&(o=1),"undefined"==typeof n&&(n=!1);for(var r=[],a=0;a<this.source.length;a++)r.push(this.slavePlay(a,e,t,o,n,i));return r},HAPIAudio.prototype.slavePlay=function(e,t,o,n,i,s){var a=this;if("undefined"==typeof t&&(t=0),"undefined"==typeof o&&(o=1),"undefined"==typeof n&&(n=1),("function"!=typeof i||e>0)&&(i=function(){}),this.isLoaded[e]!==!0)return!1;if(this.isPlaying[e]===!0&&"undefined"!=typeof s)return this.context[e].noteOff(0),setTimeout(function(){a.slavePlay(e,t,o,n,i,s)},10),!0;if(this.isPlaying[e]===!0&&"undefined"==typeof s)return this.stopType[e]!==!1&&this.pausedContextTime[e]===!1?("volume"==this.stopType[e]?(this.stopType[e]=!1,this.slaveSetVolume(e,n,this.stopContextTimeFinish[e]-this.stopContextTimeBegin[e]-(this.stopContextTimeFinish[e]-audioContext.currentTime))):"rate"==this.stopType[e]&&(this.stopType[e]=!1,this.slaveSetRate(e,o,this.stopContextTimeFinish[e]-this.stopContextTimeBegin[e]-(this.stopContextTimeFinish[e]-audioContext.currentTime))),this.stopContextTimeBegin[e]=!1,this.stopContextTimeFinish[e]=!1,!0):!1;this.context[e]=audioContext.createBufferSource(),this.startOffset[e]=t,this.startContextTime[e]=audioContext.currentTime,this.pausedContextTime[e]!==!1?(this.startContextTime[e]-=t,this.pausedContextTime[e]=!1):this.onEndedFunc[e]=i,"undefined"==typeof a.context[e].noteOn&&(a.context[e].noteOn=a.context[e].start),"undefined"==typeof a.context[e].noteGrainOn&&(a.context[e].noteGrainOn=a.context[e].start),"undefined"==typeof a.context[e].noteOff&&(a.context[e].noteOff=a.context[e].stop),this.context[e].buffer=this.buffer[e],this.context[e].connect(this.volume[e]),this.volume[e].gain.value=n,this.volume[e].gain.cancelScheduledValues(0),this.volume[e].gain.setValueAtTime(n,0),this.context[e].playbackRate.value=o,this.context[e].playbackRate.cancelScheduledValues(0),this.context[e].playbackRate.setValueAtTime(o,0),this.volume[e].connect(a.scriptProcessor[e]),this.scriptProcessor[e].connect(audioContextVolume),null!=a.scriptProcessorDisconnect[e]&&(clearTimeout(a.scriptProcessorDisconnect[e]),a.scriptProcessorDisconnect[e]=null),0==t?this.context[e].noteOn(0):this.context[e].noteGrainOn(0,t,this.buffer[e].duration),this.context[e].loop=!1,this.manualOnEnded[e]=!0;for(var r in this.context[e])"onended"==r&&(this.manualOnEnded[e]=!1);return this.context[e].onended=function(){a.isPlaying[e]=!1,a.pausedContextTime[e]===!1&&a.onEndedFunc[e](),a.volume[e].disconnect(a.scriptProcessor[e]),a.scriptRun[e]=!1,a.scriptProcessorDisconnect[e]=setTimeout(function(){a.scriptProcessor[e].disconnect(audioContextVolume)},250)},this.isPlaying[e]=!0,a.scriptRun[e]=!0,this.stopInterval[e]=setInterval(function(){if(0==a.isPlaying[e])clearInterval(a.stopInterval[e]),a.stopInterval[e]=!1;else{if(1==a.manualOnEnded[e]&&0==a.context[e].loop&&audioContext.currentTime>a.startContextTime[e]+a.buffer[e].duration/a.context[e].playbackRate.value)return void a.slaveStop(e);if(a.stopType[e]===!1)return;"volume"==a.stopType[e]?0==a.volume[e].gain.value&&a.slaveStop(e):"rate"==a.stopType[e]&&a.context[e].playbackRate.value<=1e-4&&a.slaveStop(e)}},10),!0},HAPIAudio.prototype.pan=function(e){for(var t=!1,o=0;o<this.isLoaded.length;o++)this.isLoaded[o]!==!0&&(t=!0);if(1==t)return!1;for(var n=[],o=0;o<this.source.length;o++)n.push(this.slavePan(o,e));return n},HAPIAudio.prototype.slavePan=function(e,t){var o=this;return o.scriptProcessor[e].disconnect(),o.scriptProcessor[e].connect(o.panner[e]),o.panner[e].connect(audioContextVolume),this.isLoaded[e]!==!0?!1:this.isPlaying[e]!==!0?!1:(this.panner[e].setPosition(t,0,1-Math.abs(t)),!0)},HAPIAudio.prototype.stop=function(e,t,o){for(var n=!1,i=0;i<this.isLoaded.length;i++)this.isLoaded[i]!==!0&&(n=!0);if(1==n)return!1;for(var s=[],i=0;i<this.source.length;i++)s.push(this.slaveStop(i,e,t,o));return s},HAPIAudio.prototype.slaveStop=function(e,t,o,n){var i=this;return this.isLoaded[e]!==!0?!1:this.isPlaying[e]!==!0?this.pausedContextTime[e]!==!1?(this.pausedContextTime[e]=!1,this.onEndedFunc[e](),!0):!1:this.stopType[e]!==!1&&"undefined"!=typeof t?!1:("undefined"==typeof o&&(o=2),"undefined"==typeof n&&(n=0),void("undefined"!=typeof t?"volume"==t?(i.stopContextTimeBegin[e]=audioContext.currentTime+n,i.stopContextTimeFinish[e]=audioContext.currentTime+o+n,i.slaveSetVolume(e,0,o,n),i.stopType[e]="volume"):"rate"==t?(i.stopContextTimeBegin[e]=audioContext.currentTime+n,i.stopContextTimeFinish[e]=audioContext.currentTime+o+n,i.slaveSetRate(e,1e-4,o,n),i.stopType[e]="rate"):(i.context[e].noteOff(0),i.stopContextTimeBegin[e]=!1,i.stopContextTimeFinish[e]=!1,i.stopType[e]=!1,1==i.manualOnEnded[e]&&i.context[e].onended()):(i.context[e].noteOff(0),i.stopContextTimeBegin[e]=!1,i.stopContextTimeFinish[e]=!1,i.stopType[e]=!1,1==i.manualOnEnded[e]&&i.context[e].onended())))},HAPIAudio.prototype.pause=function(e,t,o){for(var n=!1,i=0;i<this.isLoaded.length;i++)this.isLoaded[i]!==!0&&(n=!0);if(1==n)return!1;for(var s=[],i=0;i<this.source.length;i++)s.push(this.slavePause(i,e,t,o));return s},HAPIAudio.prototype.slavePause=function(e,t,o,n){var i=this;if(this.isLoaded[e]!==!0)return!1;if(this.isPlaying[e]!==!0)return!1;if(this.stopType[e]!==!1&&"undefined"!=typeof t)return!1;if(i.pausedContextTime[e]=audioContext.currentTime-i.startContextTime[e],0!=i.loopEnd[e])for(;i.pausedContextTime[e]>i.loopEnd[e];)i.pausedContextTime[e]-=i.loopEnd[e]-i.loopStart[e];return i.slaveStop(e,t,o,n),!0},HAPIAudio.prototype.resume=function(e,t,o){for(var n=!1,i=0;i<this.isLoaded.length;i++)this.isLoaded[i]!==!0&&(n=!0);if(1==n)return!1;for(var s=[],i=0;i<this.source.length;i++)s.push(this.slaveResume(i,e,t,o));return s},HAPIAudio.prototype.slaveResume=function(e,t,o,n){var i=this;return this.isLoaded[e]!==!0?!1:this.isPlaying[e]===!0?!1:this.stopType[e]!==!1&&"undefined"!=typeof type?!1:void(0!=i.loopEnd[e]?i.slaveLoop(e,i.pausedContextTime[e]!==!1?i.pausedContextTime[e]:0,t,o,i.onEndedFunc[e],n):i.slavePlay(e,i.pausedContextTime[e]!==!1?i.pausedContextTime[e]:0,t,o,i.onEndedFunc[e],n))},HAPIAudio.prototype.setVolume=function(e,t,o){for(var n=!1,i=0;i<this.isLoaded.length;i++)this.isLoaded[i]!==!0&&(n=!0);if(1==n)return!1;for(var s=[],i=0;i<this.source.length;i++)s.push(this.slaveSetVolume(i,e,t,o));return s},HAPIAudio.prototype.slaveSetVolume=function(e,t,o,n){var i=this;return this.isLoaded[e]!==!0?!1:this.isPlaying[e]!==!0?!1:"volume"===this.stopType[e]?!1:("undefined"==typeof o&&(o=0),"undefined"==typeof n&&(n=0),this.volume[e].gain.cancelScheduledValues(0),o>0?(this.volume[e].gain.setValueAtTime(i.volume[e].gain.value,audioContext.currentTime),n>0&&this.volume[e].gain.setValueAtTime(i.volume[e].gain.value,audioContext.currentTime+n),this.volume[e].gain.linearRampToValueAtTime(t,audioContext.currentTime+o+n)):this.volume[e].gain.setValueAtTime(t,audioContext.currentTime+n),!0)},HAPIAudio.prototype.setRate=function(e,t,o){for(var n=!1,i=0;i<this.isLoaded.length;i++)this.isLoaded[i]!==!0&&(n=!0);if(1==n)return!1;for(var s=[],i=0;i<this.source.length;i++)s.push(this.slaveSetRate(i,e,t,o));return s},HAPIAudio.prototype.slaveSetRate=function(e,t,o,n){var i=this;return this.isLoaded[e]!==!0?!1:this.isPlaying[e]!==!0?!1:"rate"===this.stopType[e]?!1:("undefined"==typeof o&&(o=0),"undefined"==typeof n&&(n=0),this.context[e].playbackRate.cancelScheduledValues(0),o>0?(this.context[e].playbackRate.setValueAtTime(i.context[e].playbackRate.value,audioContext.currentTime),n>0&&this.context[e].playbackRate.setValueAtTime(i.context[e].playbackRate.value,audioContext.currentTime+n),this.context[e].playbackRate.linearRampToValueAtTime(t,audioContext.currentTime+o+n)):this.context[e].playbackRate.setValueAtTime(t,audioContext.currentTime+n),!0)};