var fishObject=function(t,i,e,s,o,h,n,a,r,c){var l=this;PIXI.Sprite.call(this),this.destroyed=!1,this.direction=Math.random()>.5?DIRECTION.LEFT:DIRECTION.RIGHT,this.speed=this.direction==DIRECTION.LEFT?-Math.abs(o):Math.abs(o),this.parentScene=r,this.parentStage=c,this.strength=h,this.initialTension=n,this.position="undefined"==typeof t?{x:640,y:540}:{x:t.x+0,y:t.y+0},this.initialPosition="undefined"==typeof t?{x:640,y:540}:{x:t.x+0,y:t.y+0},this.anchor={x:.5,y:.5},this._order=1,this.size=e,this._alpha=new HAPIPair(1,1),this.notice=s,this.scale={x:i,y:i},this.swimArea="undefined"==typeof a?{l:0,r:renderer.width-192,h:64}:a,this._children=[],this.noticeTimeout=0,this._children.push(new PIXI.Sprite),this._children[0].addChild(new PIXI.Sprite),this._children[0].addChild(new PIXI.Sprite),this._children[0].children[0].texture=new PIXI.Texture(loader.textures.fish.texture.baseTexture,new PIXI.Rectangle(0,0,150,150)),this._children[0].children[1].texture=new PIXI.Texture(loader.textures.fish.texture.baseTexture,new PIXI.Rectangle(150,0,150,150)),this._children[0].children[0].anchor=this._children[0].children[1].anchor={x:.5,y:.5},this._children[0].children[1].tint=fishObject.fishColors[parseInt(Math.random()*(fishObject.fishColors.length-1))],this._children.push(new HAPIMask(this,s,"0xFF0000")),this._children.push(new HAPIMask(this,e,"0x0000FF")),this._children.push(new HAPIMask(void 0,{x:this.swimArea.l,y:this.position.y-this.swimArea.h,w:this.swimArea.r-this.swimArea.l,h:2*this.swimArea.h},"0x00FF00","undefined"==typeof this.parentStage?this.parentScene.renderStage:this.parentStage)),this._children[0].width=this._children[0].height=150,this._children[0].anchor={x:.5,y:.5},this._children[0].parentStage=this,this._children[0]._oscillatorX=new HAPIPair(.95,1.05).start(1e3,MODE.HAPIPair.DURATION,MODE.HAPIPair.OSCILLATE),this._children[0]._oscillatorY=new HAPIPair(1.05,.95).start(1e3,MODE.HAPIPair.DURATION,MODE.HAPIPair.OSCILLATE),this._children[0].logic=function(){this._oscillatorX.logic(),this._oscillatorY.logic(),"undefined"==typeof this.parentStage?0==this.parentScene.renderStage.checkChild(this)&&this.parentScene.renderStage.addChild(this):0==this.parentStage.checkChild(this)&&this.parentStage.addChild(this)},this._children[0].destructor=function(){"undefined"==typeof l.parentStage?1==l.parentScene.renderStage.checkChild(this)&&l.parentScene.renderStage.removeChild(this):1==l.parentStage.checkChild(this)&&l.parentStage.removeChild(this)},MODE.add("fishObject",["NULL","SWIM","TURN","PERSUE","HOOKEDDRAG","HOOKEDSTRUGGLE","CAUGHT","FANFARE"]),this.mode=MODE.fishObject.SWIM,this._scale=this.direction==DIRECTION.LEFT?new HAPIPair(1,1):new HAPIPair(-1,-1),this._scaleTo=1,this._rotation=Math.PI,this._turningRotation=new HAPIPair(0,0)};fishObject.prototype=new PIXI.Sprite,fishObject.prototype.constructor=fishObject,fishObject.prototype.destructor=function(){for(var t=0;t<this._children.length;t++)"function"==typeof this._children[t].destructor&&this._children[t].destructor();"undefined"==typeof this.parentStage?1==this.parentScene.renderStage.checkChild(this)&&this.parentScene.renderStage.removeChild(this):1==this.parentStage.checkChild(this)&&this.parentStage.removeChild(this)},fishObject.prototype.noticeBox=function(){return[this.position.x-this.notice.x,this.position.x+this.notice.x,this.position.y-this.notice.y,this.position.y+this.notice.y]},fishObject.prototype.collisionBox=function(){return[this.position.x-this.size.x,this.position.x+this.size.x,this.position.y-this.size.y,this.position.y+this.size.y]},fishObject.prototype.chaseBox=function(){return[this.swimArea.l,this.swimArea.r,this.initialPosition.y-this.swimArea.h,this.initialPosition.y+this.swimArea.h]},fishObject.prototype.movement=function(t){switch(t){case MODE.fishObject.SWIM:this.position.x+=calcSpeedPixel(this.speed),this.collisionBox()[0]<=this.swimArea.l?(this.position.x=this.swimArea.l+this.size.x,this.direction=DIRECTION.RIGHT,this.speed=-this.speed,this._scale.set(this._scale.current,-1).start(.25,MODE.HAPIPair.VALUE),this._rotation=Math.PI):this.collisionBox()[1]>=this.swimArea.r&&(this.position.x=this.swimArea.r-this.size.x,this.direction=DIRECTION.LEFT,this.speed=-this.speed,this._scale.set(this._scale.current,1).start(.25,MODE.HAPIPair.VALUE),this._rotation=0),this.position.y>this.initialPosition.y?(this.position.y-=Math.abs(this.speed)/5>.25?Math.abs(this.speed)/5:.25,this.position.y<this.initialPosition.y&&(this.position.y=this.initialPosition.y)):this.position.y<this.initialPosition.y&&(this.position.y+=Math.abs(this.speed)/5>.25?Math.abs(this.speed)/5:.25,this.position.y>this.initialPosition.y&&(this.position.y=this.initialPosition.y));break;case MODE.fishObject.PERSUE:this.position.x-=calcSpeedPixel(Math.abs(this.speed))*Math.cos(this._lookAtRotation),this.position.y-=calcSpeedPixel(Math.abs(this.speed))*Math.sin(this._lookAtRotation)}},fishObject.prototype.logic=function(){var t=this;if(this.alpha!=this._alpha.current&&(this.alpha=this._alpha.current),1!=this.destroyed){switch("undefined"==typeof this.parentStage?0==this.parentScene.renderStage.checkChild(this)&&this.parentScene.renderStage.addChild(this):0==this.parentStage.checkChild(this)&&this.parentStage.addChild(this),this._scale.logic(),this.noticeTimeout>0&&this.noticeTimeout--,this.mode){case MODE.fishObject.SWIM:if(this._children[0].scale={x:this._scale.current*this._children[0]._oscillatorX.current,y:1*this._children[0]._oscillatorY.current},this.movement(this.mode),this.parentScene.hookObject.x>=this.noticeBox()[BOUNDS.XL]&&this.parentScene.hookObject.x<=this.noticeBox()[BOUNDS.XR]&&this.parentScene.hookObject.y>=this.noticeBox()[BOUNDS.YT]&&this.parentScene.hookObject.y<=this.noticeBox()[BOUNDS.YB]&&this.parentScene.hookObject.x>=this.chaseBox()[BOUNDS.XL]&&this.parentScene.hookObject.x<=this.chaseBox()[BOUNDS.XR]&&this.parentScene.hookObject.y>=this.chaseBox()[BOUNDS.YT]&&this.parentScene.hookObject.y<=this.chaseBox()[BOUNDS.YB]&&"undefined"==typeof this.parentScene.hookObject.hookedFish&&0==this.noticeTimeout){for(this.mode=MODE.fishObject.TURN,this._lookAtRotation=Math.atan2(this.position.y-this.parentScene.hookObject.y,this.position.x-this.parentScene.hookObject.x);this._lookAtRotation>Math.PI;)this._lookAtRotation-=2*Math.PI;for(;this._lookAtRotation<-Math.PI;)this._lookAtRotation+=2*Math.PI;this._turningRotation.set(this._rotation,this._lookAtRotation).start(.02,MODE.HAPIPair.VALUE)}break;case MODE.fishObject.TURN:if(this.parentScene.hookObject.mode!=MODE.hookObject.SINKING&&this.parentScene.hookObject.mode!=MODE.hookObject.SHUFFLING||!(this.parentScene.hookObject.x>=this.chaseBox()[BOUNDS.XL]&&this.parentScene.hookObject.x<=this.chaseBox()[BOUNDS.XR]&&this.parentScene.hookObject.y>=this.chaseBox()[BOUNDS.YT]&&this.parentScene.hookObject.y<=this.chaseBox()[BOUNDS.YB]))return this.mode=MODE.fishObject.SWIM,this.direction=DIRECTION.LEFT,this.speed=-Math.abs(this.speed),1!=this._scale.current?(this._scale.set(this._scale.current,1).start(.25,MODE.HAPIPair.VALUE),this._rotation=this.rotation=0):(this._scale.set(this._scale.current,0).start(.125,MODE.HAPIPair.VALUE),setTimeout(function(){t._rotation=t.rotation=0,t._scale.set(t._scale.current,1).start(.125,MODE.HAPIPair.VALUE)},125)),void(this.noticeTimeout=10);for(this._lookAtRotation=Math.atan2(this.position.y-this.parentScene.hookObject.y,this.position.x-this.parentScene.hookObject.x);this._lookAtRotation>Math.PI;)this._lookAtRotation-=2*Math.PI;for(;this._lookAtRotation<-Math.PI;)this._lookAtRotation+=2*Math.PI;this._turningRotation.end=this._lookAtRotation,1==this._turningRotation.logic()&&(this.mode=MODE.fishObject.PERSUE),this._rotation=this._turningRotation.current,(this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1)!=this._scaleTo&&(this._scaleTo=this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1,this._scale.set(this._scale.current,this._scaleTo).start(.25,MODE.HAPIPair.VALUE)),this._children[0].scale={x:1,y:this._scale.current},this.rotation=this.scale.x<0?this._rotation+Math.PI:this._rotation;break;case MODE.fishObject.PERSUE:if(this.parentScene.hookObject.mode!=MODE.hookObject.SINKING&&this.parentScene.hookObject.mode!=MODE.hookObject.SHUFFLING||!(this.parentScene.hookObject.x>=this.chaseBox()[BOUNDS.XL]&&this.parentScene.hookObject.x<=this.chaseBox()[BOUNDS.XR]&&this.parentScene.hookObject.y>=this.chaseBox()[BOUNDS.YT]&&this.parentScene.hookObject.y<=this.chaseBox()[BOUNDS.YB]))return this.mode=MODE.fishObject.SWIM,this.direction=DIRECTION.LEFT,this.speed=-Math.abs(this.speed),1!=this._scale.current?(this._scale.set(this._scale.current,1).start(.25,MODE.HAPIPair.VALUE),this._rotation=this.rotation=0):(this._scale.set(this._scale.current,0).start(.125,MODE.HAPIPair.VALUE),setTimeout(function(){t._rotation=t.rotation=0,t._scale.set(t._scale.current,1).start(.125,MODE.HAPIPair.VALUE)},125)),void(this.noticeTimeout=10);for(this._lookAtRotation=Math.atan2(this.position.y-this.parentScene.hookObject.y,this.position.x-this.parentScene.hookObject.x);this._lookAtRotation>Math.PI;)this._lookAtRotation-=2*Math.PI;for(;this._lookAtRotation<-Math.PI;)this._lookAtRotation+=2*Math.PI;var i=calcSpeedPixel(180/Math.PI);if(this._lookAtRotation>this._rotation?this._lookAtRotation>this._rotation+i?this._rotation+=i:this._rotation=this._lookAtRotation:this._lookAtRotation<this._rotation&&(this._lookAtRotation<this._rotation-i?this._rotation-=i:this._rotation=this._lookAtRotation),(this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1)!=this._scaleTo&&(this._scaleTo=this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1,this._scale.set(this._scale.current,this._scaleTo).start(.25,MODE.HAPIPair.VALUE)),this.movement(this.mode),this._children[0].scale={x:1*this._children[0]._oscillatorX.current,y:this._scale.current*this._children[0]._oscillatorY.current},this.rotation=this.scale.x<0?this._rotation+Math.PI:this._rotation,this.parentScene.hookObject.x>=this.collisionBox()[BOUNDS.XL]&&this.parentScene.hookObject.x<=this.collisionBox()[BOUNDS.XR]&&this.parentScene.hookObject.y>=this.collisionBox()[BOUNDS.YT]&&this.parentScene.hookObject.y<=this.collisionBox()[BOUNDS.YB]){this.mode=MODE.fishObject.HOOKEDSTRUGGLE,this.parentScene.hookObject.mode=MODE.hookObject.REELING,this.parentScene.hookObject.hookedFish=this,this.parentScene.lineTension=this.initialTension+(Math.random()-.5);var t=this;musicLibrary.pause(this.parentScene.music),musicLibrary.play("fishing",1,1,0),this.parentScene.onscreenText.set("hit").appear(),this.parentScene.onscreenText._timeout=setTimeout(function(){t.parentScene.onscreenText.disappear()},3e3)}break;case MODE.fishObject.HOOKEDDRAG:var e=Math.random()*((this.strength-this.parentScene.hookObject.strength)/5);0==e&&(e=.01),e*=1.5*Math.random()-.3,this.parentScene.lineTension+=e;var i=calcSpeedPixel(180/Math.PI)/200;this._lookAtRotation>this._rotation?this._lookAtRotation>this._rotation+i?this._rotation+=i:this._rotation=this._lookAtRotation:this._lookAtRotation<this._rotation&&(this._lookAtRotation<this._rotation-i?this._rotation-=i:this._rotation=this._lookAtRotation),(this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1)!=this._scaleTo&&(this._scaleTo=this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1,this._scale.set(this._scale.current,this._scaleTo).start(.25,MODE.HAPIPair.VALUE)),this._children[0].scale={x:1*this._children[0]._oscillatorX.current,y:this._scale.current*this._children[0]._oscillatorY.current},this.rotation=this.scale.x<0?this._rotation+Math.PI:this._rotation;break;case MODE.fishObject.HOOKEDSTRUGGLE:this.parentScene.lineTension>this.initialTension?this.parentScene.lineTension-=this.strength/5*Math.random():this.parentScene.lineTension<this.initialTension&&(this.parentScene.lineTension+=this.strength/5*Math.random()),this._lookAtRotation=0;var i=calcSpeedPixel(180/Math.PI)/200;this._lookAtRotation>this._rotation?this._lookAtRotation>this._rotation+i?this._rotation+=i:this._rotation=this._lookAtRotation:this._lookAtRotation<this._rotation&&(this._lookAtRotation<this._rotation-i?this._rotation-=i:this._rotation=this._lookAtRotation),(this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1)!=this._scaleTo&&(this._scaleTo=this._rotation>Math.PI/2||this._rotation<-Math.PI/2?-1:1,this._scale.set(this._scale.current,this._scaleTo).start(.25,MODE.HAPIPair.VALUE)),this._children[0].scale={x:1*this._children[0]._oscillatorX.current,y:this._scale.current*this._children[0]._oscillatorY.current},this.rotation=(this.scale.x<0?this._rotation+Math.PI:this._rotation)+(Math.random()-.5)/5,this.position.x-=Math.abs(this.speed)/2,this.position.y>this.initialPosition.y?(this.position.y-=Math.abs(this.speed)/10,this.position.y<this.initialPosition.y&&(this.position.y=this.initialPosition.y)):this.position.y<this.initialPosition.y&&(this.position.y+=Math.abs(this.speed)/10,this.position.y>this.initialPosition.y&&(this.position.y=this.initialPosition.y));break;case MODE.fishObject.CAUGHT:this.position={x:this.parentScene.hookObject.x,y:this.parentScene.hookObject.y},this._children[0].scale={x:1,y:this._scale.current};break;case MODE.fishObject.FANFARE:0==musicLibrary.check("fishget","playing")&&(0==this._alpha.active&&(this._alpha.set(1,0).start(250,MODE.HAPIPair.DURATION),setTimeout(function(){t.destructor()},250)),this.destroyed=!0,this.mode=MODE.fishObject.NULL)}for(var s=0;s<this._children.length;s++)this._children[s].logic()}},fishObject.fishColors=[16711680,16744448,16776960,8453888,65280,65408,65535,33023,255,8388863,16711935,16711808,16711680];var froggyObject=function(t,i,e,s,o,h,n,a,r){fishObject.call(this,t,.75,i,e,s,h,n,void 0,a,r),this._children[0].removeChild(this._children[0].children[1]),this._children[0].removeChild(this._children[0].children[0]),this._children[0].addChild(new PIXI.Sprite),this._children[0].children[0].texture=froggyObject.frames[1],this._children[0].children[0].anchor={x:.25,y:.5},this.movementLooper=new HAPIPair(1,0),this.pushTime=o,this.currentFrame=1};froggyObject.prototype=Object.create(fishObject.prototype),froggyObject.prototype.constructor=froggyObject,froggyObject.prototype.logic=function(){fishObject.prototype.logic.call(this),this.movementLooper.logic(),this.mode==MODE.fishObject.SWIM||this.mode==MODE.fishObject.PERSUE?0==this.movementLooper.active&&this.movementLooper.set(1,0).start(this.pushTime,MODE.HAPIPair.DURATION,MODE.HAPIPair.LOOP):1==this.movementLooper.active&&this.movementLooper.stop(!0),this.animate()},froggyObject.prototype.animate=function(){var t=this.currentFrame;switch(this.mode){case MODE.fishObject.SWIM:case MODE.fishObject.PERSUE:t=this.movementLooper.current<.1?0:1;break;case MODE.fishObject.TURN:case MODE.fishObject.HOOKEDDRAG:case MODE.fishObject.HOOKEDSTRUGGLE:t=Math.floor(performance.now()/100%2);break;case MODE.fishObject.NULL:case MODE.fishObject.CAUGHT:case MODE.fishObject.FANFARE:t=1}t!=this.currentFrame&&(this.currentFrame=t,this._children[0].children[0].texture=froggyObject.frames[t])},froggyObject.prototype.movement=function(t){switch(t){case MODE.fishObject.SWIM:this.position.x+=calcSpeedPixel(this.speed)*this.movementLooper.current,this.collisionBox()[0]<=this.swimArea.l?(this.position.x=this.swimArea.l+this.size.x,this.direction=DIRECTION.RIGHT,this.speed=-this.speed,this._scale.set(this._scale.current,-1).start(.25,MODE.HAPIPair.VALUE),this._rotation=Math.PI):this.collisionBox()[1]>=this.swimArea.r&&(this.position.x=this.swimArea.r-this.size.x,this.direction=DIRECTION.LEFT,this.speed=-this.speed,this._scale.set(this._scale.current,1).start(.25,MODE.HAPIPair.VALUE),this._rotation=0),this.position.y>this.initialPosition.y?(this.position.y-=Math.abs(this.speed)/5>.25?Math.abs(this.speed)/5*this.movementLooper.current:.25*this.movementLooper.current,this.position.y<this.initialPosition.y&&(this.position.y=this.initialPosition.y)):this.position.y<this.initialPosition.y&&(this.position.y+=Math.abs(this.speed)/5>.25?Math.abs(this.speed)/5*this.movementLooper.current:.25*this.movementLooper.current,this.position.y>this.initialPosition.y&&(this.position.y=this.initialPosition.y));break;case MODE.fishObject.PERSUE:this.position.x-=calcSpeedPixel(Math.abs(this.speed))*Math.cos(this._lookAtRotation)*this.movementLooper.current,this.position.y-=calcSpeedPixel(Math.abs(this.speed))*Math.sin(this._lookAtRotation)*this.movementLooper.current}},loader.waitForTexture("fishing_froggy",function(){froggyObject.frames=[new PIXI.Texture(loader.textures.fishing_froggy.texture.baseTexture,new PIXI.Rectangle(0,0,90,90)),new PIXI.Texture(loader.textures.fishing_froggy.texture.baseTexture,new PIXI.Rectangle(90,0,90,90))]});